# 密码学

## 对称加密

### 对称加密原理

- 要素

	- 明文

	- 加密算法

	- 秘钥

	- 密文

	- 解密算法

- 密码分析

	- 唯密文

		- 密文

	- 已知明文

		- 密文

		- 秘钥产生的明文-密文对

	- 选择明文

		- 密文

		- 选定的明文信息，以及使用秘钥产生的密文

	- 选择密文

		- 密文

		- 选定的密文信息，以及使用秘钥产生的解密明文

	- 选择文本

		- 密文

		- 选定的明文信息，以及使用秘钥产生的密文

		- 选定的密文信息，以及使用秘钥产生的解密明文

- Feistel密码结构

	- 对称分组加密算法

		- 2w长度的明文信息，每一轮次均执行LEi xor F(REi, ki)作为下一轮的RE，本轮RE成为下一轮LE

		- 分组大小、秘钥大小、迭代轮数、子秘钥产生算法、轮函数

### 对称分组加密算法

- 分组密码处理固定大小的明文输入分组，对每个明文分组产生同等大小的密文分组

- DES

	- 明文长度64比特，秘钥长度56比特

- 3DES

	- 加密三次使用DES算法，加密-解密-加密过程使用不同秘钥

	- C=E(K3, D(K2, E(K1, P)))

- AES

	- 分组大小128bit，秘钥长度128、192、256bit

	- 不是典型的feistel结构，每次轮换和移位时都并行处理整个数据分组

	- 秘钥扩展为44个32bit字的数组，每四个字作为一轮的轮秘钥

	- 四个变化函数

		- 字节替换

			- 用S盒对分组逐一的字节替换

		- 行移位

			- 列简单移位

		- 列混合

			- 对列的每个字节替换，是一个与本列全部字节相关的函数

		- 轮秘钥加

			- 当前分组异或一部分扩展秘钥

### 随机数和伪随机数

- 特性

	- 随机性、不可预测性

- 真随机数发生器

- 伪随机数发生器

- 伪随机函数

### 流密码和RC4

- 使用伪随机字节产生器（密钥流产生器）把秘钥转化为秘钥流，异或明文流产生密文流

- RC4

	- 子主题 1

### 分组密码工作模式

- 电子密码本模式

	- 一次处理固定量比特，明文每个分组都使用同一秘钥加密

- 密码分组链接模式

	- 当前轮次的输入为前一次密文和当前明文的异或，再使用同一秘钥加密

- 密码反馈模式

	- 加密模块的输入是一个64位的移位寄存器，初始化为IV。经加密后，取密文最高开始的s位异或明文s位为c并传输。之后寄存器左移s位，空出的位置填入c，重复过程直到全部明文被加密发送

- 计数器模式

## 公钥密码和消息认证

### 消息认证方法

- 消息认证

	- 验证信息有无被篡改

	- 来源是否可信

	- 信息时效性

- 非加密的消息认证

	- 消息认证码

		- 将秘钥连同消息进行计算，生成消息认证码，一并发送。接收方用相同的秘钥计算认证码

		- 可以做到：1、辨别是否被篡改；2、确定消息来源是否是授权；3、如果有序列号，则可以确定正确序列

	- 单项散列函数

		- 利用单项散列函数，计算变长消息的固定长度摘要，经处理后随消息一同发送

			- 使用传统加密方式加密消息摘要

				- 通信双方使用同一秘钥，加密的消息摘要在bob被解码，同bob自己计算出的消息摘要对比

			- 使用公钥加密信息摘要

				- alice用其公钥加密消息摘要，bob接受后使用alice的秘钥解密，并与自己计算的摘要对比

			- 使用秘密值

				- Alice&Bob共享一个秘密值S，计算摘要时连同S一起计算；消息连同摘要一起发送，Bob接受后，加上S计算摘要并对比

### 安全散列函数

- 性质

	- 适用于生成任意长度的数据块

	- 生成固定长度的输出

	- 知道x，正向计算H(x)容易

	- 知道H(x)，反向计算x在计算上不可行

		- 单向性、抗原像攻击性

	- f=H(x)是一一映射的函数，一个特定的x有且仅有一个H(x)

		- 抗第二原像攻击性

	- 知道H(x)，暴力碰撞出y，使得H(x)=H(y)在计算上是不可能的

		- 抗碰撞性

- SHA安全散列函数

	- 追加填充比特

	- 追加长度

	- 初始化散列缓冲区

	- 处理1024bit数据块消息

### 消息认证码

- HMAC

- 基于分组密码的MAC

### 公钥密码原理

- 要素

	- 明文

	- 加密算法

	- 公钥和私钥

	- 密文

	- 解密算法

- 分类

	- 加解密

		- 发送者用接受者的公钥加密信息

	- 数字签名

		- 发送者使用自己的秘钥签名信息

	- 密钥交换

		- 通信双方交换会话密钥

- 要求

	- Bob计算密钥对较为容易

	- 已知Bob的公钥和消息时，Alice容易计算密文

	- Bob容易通过私钥解密密文

	- 通过公钥不可能计算私钥

	- 知道密文和公钥不可能恢复明文

### 公钥密码算法

- RSA

	- 要素

		- 模值n

		- 互质大素数p、q

	- 运算

		- 生成公钥{e,n}

			- 选择e，使得e与(p-1)(q-1)互质且小于

		- 生成私钥{d,n}

			- 解方程 ed mod (p-1)(q-1) = 1

		- 加密

			- C=M^e mod n

			- n = pq

		- 解密

			- M = C^d mod n

- D-H密钥交换

	- 基于离散对数的计算困难性

	- 仅使用密钥交换协议，不能抵抗中间人攻击

- 数字签名标准

- 椭圆曲线算法

### 数字签名

- 保证了消息源和数据完整性

- 对消息全体使用散列码，生成认证符，再对认证符签名，就不用对全部消息加密，节省了开支

